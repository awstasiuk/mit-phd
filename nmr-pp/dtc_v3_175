; 23 June 2022
; Andrew Stasiuk
;
; ZZ Correlation under periodic kicking
; Discrete Time Crystal Experiments, version 3
; Scrambling time at 120us
; Interaction and Disorder Strength set by Ken16
; theta=175


; cnst1 multiplies disZ, cnst2 multiplies Dz
; H_eff = (1/3)*cnst1*sum(h_i Z_i) + cnst2 * Dz

define delay tau1
"tau1 = d3*(1+cnst1+2*cnst2)-p1/2"
define delay tau2
"tau2 = d3*(1-cnst2)-p1"
define delay tau3
"tau3 = 2*d3*(1-cnst2)-p1"

define delay tau1p
"tau1p = d3*(1-cnst1+2*cnst2)-p1/2"
define delay tau2p
"tau2p = d3*(1-cnst2)-p1"
define delay tau3p
"tau3p = 2*d3*(1-cnst2)-p1"

define delay cycle
"cycle=24*d3"

; First measurement length is 0. Ensure L[1]=0 as well.
"l1=0"

; start the pulse program
1   ze

; reset delay
2   d1 rpp10 rpp11 rpp12 rpp13 rpp20 rpp21
    cycle pl2:f2

; Kicking + Ken16
3
    (p1 ph20^):f2
    2.5u
    (p1 ph21^):f2

    tau1
    (p1 ph10^):f2
    tau2
    (p1 ph10^):f2
    tau3
    (p1 ph10^):f2
    tau2p
    (p1 ph10^):f2
    tau1p

    tau1p
    (p1 ph11^):f2
    tau2
    (p1 ph11^):f2
    tau3p
    (p1 ph11^):f2
    tau2p
    (p1 ph11^):f2
    tau1

    tau1
    (p1 ph12^):f2
    tau2p
    (p1 ph12^):f2
    tau3p
    (p1 ph12^):f2
    tau2
    (p1 ph12^):f2
    tau1p

    tau1p
    (p1 ph13^):f2
    tau2p
    (p1 ph13^):f2
    tau3
    (p1 ph13^):f2
    tau2
    (p1 ph13^):f2
    tau1

    lo to 3 times l1

    ; Measure
    d13
4   (p1 ph6):f2

    go=2 ph31

    1m wr #0 if #0

    ; increase evolution time by 1 cycle length, and re-scan
    1m iu1
    lo to 2 times td2

    ; Average over many instances of disorder.
    1m ru1
    lo to 2 times td1

    exit


; Ken16 phase programs
ph10 = (360) 185 275 275 185 10 100 100 10 195 285 285 195 20 110 110 20 205 295 295 205 30 120 120 30 215 305 305 215 40 130 130 40 225 315 315 225 50 140 140 50 235 325 325 235 60 150 150 60 245 335 335 245 70 160 160 70 255 345 345 255 80 170 170 80 265 355 355 265 90 180 180 90 275 5 5 275 100 190 190 100 285 15 15 285 110 200 200 110 295 25 25 295 120 210 210 120 305 35 35 305 130 220 220 130 315 45 45 315 140 230 230 140 325 55 55 325 150 240 240 150 335 65 65 335 160 250 250 160 345 75 75 345 170 260 260 170 355 85 85 355 180 270 270 180 5 95 95 5 190 280 280 190 15 105 105 15 200 290 290 200 25 115 115 25 210 300 300 210 35 125 125 35 220 310 310 220 45 135 135 45 230 320 320 230 55 145 145 55 240 330 330 240 65 155 155 65 250 340 340 250
ph11 = (360) 185 275 275 185 10 100 100 10 195 285 285 195 20 110 110 20 205 295 295 205 30 120 120 30 215 305 305 215 40 130 130 40 225 315 315 225 50 140 140 50 235 325 325 235 60 150 150 60 245 335 335 245 70 160 160 70 255 345 345 255 80 170 170 80 265 355 355 265 90 180 180 90 275 5 5 275 100 190 190 100 285 15 15 285 110 200 200 110 295 25 25 295 120 210 210 120 305 35 35 305 130 220 220 130 315 45 45 315 140 230 230 140 325 55 55 325 150 240 240 150 335 65 65 335 160 250 250 160 345 75 75 345 170 260 260 170 355 85 85 355 180 270 270 180 5 95 95 5 190 280 280 190 15 105 105 15 200 290 290 200 25 115 115 25 210 300 300 210 35 125 125 35 220 310 310 220 45 135 135 45 230 320 320 230 55 145 145 55 240 330 330 240 65 155 155 65 250 340 340 250
ph12 = (360) 5 95 95 5 190 280 280 190 15 105 105 15 200 290 290 200 25 115 115 25 210 300 300 210 35 125 125 35 220 310 310 220 45 135 135 45 230 320 320 230 55 145 145 55 240 330 330 240 65 155 155 65 250 340 340 250 75 165 165 75 260 350 350 260 85 175 175 85 270 0 0 270 95 185 185 95 280 10 10 280 105 195 195 105 290 20 20 290 115 205 205 115 300 30 30 300 125 215 215 125 310 40 40 310 135 225 225 135 320 50 50 320 145 235 235 145 330 60 60 330 155 245 245 155 340 70 70 340 165 255 255 165 350 80 80 350 175 265 265 175 0 90 90 0 185 275 275 185 10 100 100 10 195 285 285 195 20 110 110 20 205 295 295 205 30 120 120 30 215 305 305 215 40 130 130 40 225 315 315 225 50 140 140 50 235 325 325 235 60 150 150 60 245 335 335 245 70 160 160 70
ph13 = (360) 5 95 95 5 190 280 280 190 15 105 105 15 200 290 290 200 25 115 115 25 210 300 300 210 35 125 125 35 220 310 310 220 45 135 135 45 230 320 320 230 55 145 145 55 240 330 330 240 65 155 155 65 250 340 340 250 75 165 165 75 260 350 350 260 85 175 175 85 270 0 0 270 95 185 185 95 280 10 10 280 105 195 195 105 290 20 20 290 115 205 205 115 300 30 30 300 125 215 215 125 310 40 40 310 135 225 225 135 320 50 50 320 145 235 235 145 330 60 60 330 155 245 245 155 340 70 70 340 165 255 255 165 350 80 80 350 175 265 265 175 0 90 90 0 185 275 275 185 10 100 100 10 195 285 285 195 20 110 110 20 205 295 295 205 30 120 120 30 215 305 305 215 40 130 130 40 225 315 315 225 50 140 140 50 235 325 325 235 60 150 150 60 245 335 335 245 70 160 160 70

; Rx(theta) Phase Program
ph20 = (360) 90 295 140 345 190 35 240 85 290 135 340 185 30 235 80 285 130 335 180 25 230 75 280 125 330 175 20 225 70 275 120 325 170 15 220 65 270 115 320 165 10 215 60 265 110 315 160 5 210 55
ph21 = (360) 105 310 155 0 205 50 255 100 305 150 355 200 45 250 95 300 145 350 195 40 245 90 295 140 345 190 35 240 85 290 135 340 185 30 235 80 285 130 335 180 25 230 75 280 125 330 175 20 225 70

ph6 = 1 3
ph31 = 0 2
