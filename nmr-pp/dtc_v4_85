; 24 June 2022
; Andrew Stasiuk
;
; ZZ Correlation under periodic kicking
; Discrete Time Crystal Experiments, version 3
; Scrambling time at 120us
; Interaction and Disorder Strength set by Ken16
; theta=85
; Framechange=10


; cnst1 multiplies disZ, cnst2 multiplies Dz
; H_eff = (1/3)*cnst1*sum(h_i Z_i) + cnst2 * Dz

define delay tau1
"tau1 = d3*(1+cnst1+2*cnst2)-p1/2"
define delay tau2
"tau2 = d3*(1-cnst2)-p1"
define delay tau3
"tau3 = 2*d3*(1-cnst2)-p1"

define delay tau1p
"tau1p = d3*(1-cnst1+2*cnst2)-p1/2"
define delay tau2p
"tau2p = d3*(1-cnst2)-p1"
define delay tau3p
"tau3p = 2*d3*(1-cnst2)-p1"

define delay cycle
"cycle=24*d3"

; First measurement length is 0. Ensure L[1]=0 as well.
"l1=0"

; start the pulse program
1   ze

; reset delay
2   d1 rpp10 rpp11 rpp12 rpp13 rpp20 rpp21
    cycle pl2:f2

; Kicking + Ken16
3
    (p1 ph20^):f2
    2.5u
    (p1 ph21^):f2

    tau1
    (p1 ph10^):f2
    tau2
    (p1 ph10^):f2
    tau3
    (p1 ph10^):f2
    tau2p
    (p1 ph10^):f2
    tau1p

    tau1p
    (p1 ph11^):f2
    tau2
    (p1 ph11^):f2
    tau3p
    (p1 ph11^):f2
    tau2p
    (p1 ph11^):f2
    tau1

    tau1
    (p1 ph12^):f2
    tau2p
    (p1 ph12^):f2
    tau3p
    (p1 ph12^):f2
    tau2
    (p1 ph12^):f2
    tau1p

    tau1p
    (p1 ph13^):f2
    tau2p
    (p1 ph13^):f2
    tau3
    (p1 ph13^):f2
    tau2
    (p1 ph13^):f2
    tau1

    lo to 3 times l1

    ; Measure
    d13
4   (p1 ph6):f2

    go=2 ph31

    1m wr #0 if #0

    ; increase evolution time by 1 cycle length, and re-scan
    1m iu1
    lo to 2 times td2

    ; Average over many instances of disorder.
    1m ru1
    lo to 2 times td1

    exit


; Ken16 phase programs
ph10 = (360) 275 15 25 305 10 110 120 40 105 205 215 135 200 300 310 230 295 35 45 325 30 130 140 60 125 225 235 155 220 320 330 250 315 55 65 345 50 150 160 80 145 245 255 175 240 340 350 270 335 75 85 5 70 170 180 100 165 265 275 195 260 0 10 290 355 95 105 25 90 190 200 120 185 285 295 215 280 20 30 310 15 115 125 45 110 210 220 140 205 305 315 235 300 40 50 330 35 135 145 65 130 230 240 160 225 325 335 255 320 60 70 350 55 155 165 85 150 250 260 180 245 345 355 275 340 80 90 10 75 175 185 105 170 270 280 200 265 5 15 295 0 100 110 30 95 195 205 125 190 290 300 220 285 25 35 315 20 120 130 50 115 215 225 145 210 310 320 240 305 45 55 335 40 140 150 70 135 235 245 165 230 330 340 260 325 65 75 355 60 160 170 90 155 255 265 185 250 350 0 280
ph11 = (360) 315 55 65 345 50 150 160 80 145 245 255 175 240 340 350 270 335 75 85 5 70 170 180 100 165 265 275 195 260 0 10 290 355 95 105 25 90 190 200 120 185 285 295 215 280 20 30 310 15 115 125 45 110 210 220 140 205 305 315 235 300 40 50 330 35 135 145 65 130 230 240 160 225 325 335 255 320 60 70 350 55 155 165 85 150 250 260 180 245 345 355 275 340 80 90 10 75 175 185 105 170 270 280 200 265 5 15 295 0 100 110 30 95 195 205 125 190 290 300 220 285 25 35 315 20 120 130 50 115 215 225 145 210 310 320 240 305 45 55 335 40 140 150 70 135 235 245 165 230 330 340 260 325 65 75 355 60 160 170 90 155 255 265 185 250 350 0 280 345 85 95 15 80 180 190 110 175 275 285 205 270 10 20 300 5 105 115 35 100 200 210 130 195 295 305 225 290 30 40 320
ph12 = (360) 175 275 285 205 270 10 20 300 5 105 115 35 100 200 210 130 195 295 305 225 290 30 40 320 25 125 135 55 120 220 230 150 215 315 325 245 310 50 60 340 45 145 155 75 140 240 250 170 235 335 345 265 330 70 80 0 65 165 175 95 160 260 270 190 255 355 5 285 350 90 100 20 85 185 195 115 180 280 290 210 275 15 25 305 10 110 120 40 105 205 215 135 200 300 310 230 295 35 45 325 30 130 140 60 125 225 235 155 220 320 330 250 315 55 65 345 50 150 160 80 145 245 255 175 240 340 350 270 335 75 85 5 70 170 180 100 165 265 275 195 260 0 10 290 355 95 105 25 90 190 200 120 185 285 295 215 280 20 30 310 15 115 125 45 110 210 220 140 205 305 315 235 300 40 50 330 35 135 145 65 130 230 240 160 225 325 335 255 320 60 70 350 55 155 165 85 150 250 260 180
ph13 = (360) 215 315 325 245 310 50 60 340 45 145 155 75 140 240 250 170 235 335 345 265 330 70 80 0 65 165 175 95 160 260 270 190 255 355 5 285 350 90 100 20 85 185 195 115 180 280 290 210 275 15 25 305 10 110 120 40 105 205 215 135 200 300 310 230 295 35 45 325 30 130 140 60 125 225 235 155 220 320 330 250 315 55 65 345 50 150 160 80 145 245 255 175 240 340 350 270 335 75 85 5 70 170 180 100 165 265 275 195 260 0 10 290 355 95 105 25 90 190 200 120 185 285 295 215 280 20 30 310 15 115 125 45 110 210 220 140 205 305 315 235 300 40 50 330 35 135 145 65 130 230 240 160 225 325 335 255 320 60 70 350 55 155 165 85 150 250 260 180 245 345 355 275 340 80 90 10 75 175 185 105 170 270 280 200 265 5 15 295 0 100 110 30 95 195 205 125 190 290 300 220

ph20 = (360) 70 165 260 355 90 185 280 15 110 205 300 35 130 225 320 55 150 245 340 75 170 265 0 95 190 285 20 115 210 305 40 135 230 325 60 155 250 345 80 175 270 5 100 195 290 25 120 215 310 45
ph21 = (360) 175 270 5 100 195 290 25 120 215 310 45 140 235 330 65 160 255 350 85 180 275 10 105 200 295 30 125 220 315 50 145 240 335 70 165 260 355 90 185 280 15 110 205 300 35 130 225 320 55 150

ph6 = 1 3
ph31 = 0 2
