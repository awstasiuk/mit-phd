; 18 January 2023
; Andrew Stasiuk
; ZZ Loschmidt echo under (cnst1)*XX - (cnst1)*YY
;  frame change 13

; cnst1 = {0, .02, .04, .06, .08, .10} (td1=6)
define list<delay> tau1 = {0.00000449 0.00000449 0.00000449 0.00000449 0.00000449 0.00000449}
define list<delay> tau2 = {0.00000398 0.00000388 0.00000378 0.00000368 0.00000358 0.00000348}
define list<delay> tau3 = {0.00000898 0.00000918 0.00000938 0.00000958 0.00000978 0.00000998}

define delay cycle
"cycle=24*d3"

"l1=0"

1   ze
    ; increment the time reversal phase programs by fc*16
    25m ip4*208
    25m ip5*208
    25m ip6*208
    25m ip7*208

2
    d1 rpp0 rpp1 rpp2 rpp3 rpp4 rpp5 rpp6 rpp7
    cycle pl2:f2

3
    tau1
    (p1 ph0^):f2
    tau2
    (p1 ph1^):f2
    tau3
    (p1 ph2^):f2
    tau2
    (p1 ph3^):f2
    tau1

    lo to 3 times l1

4
    tau1
    (p1 ph4^):f2
    tau2
    (p1 ph5^):f2
    tau3
    (p1 ph6^):f2
    tau2
    (p1 ph7^):f2
    tau1

    lo to 4 times l1

    1m
    (p1 ph30):f2

    go=2 ph31
    1m wr #0 if #0

    ; increase time evolution counters
    15m iu1
    15m iu1
    15m iu1
    15m iu1

    ; increment the time reversal phase programs by fc*16 to account for additional evolution
    25m ip4*208
    25m ip5*208
    25m ip6*208
    25m ip7*208
    lo to 2 times td2

    ; increment scrambling constants, reset phase programs
    15m tau1.inc
    15m tau2.inc
    15m tau3.inc

    50m rp0
    50m rp1
    50m rp2
    50m rp3
    50m rp4
    50m rp5
    50m rp6
    50m rp7

    15m ru1
    lo to 2 times td1

  exit

ph0 = (360) 0 52 284 336 208 260 132 184 56 108 340 32 264 316 188 240 112 164 36 88 320 12 244 296 168 220 92 144 16 68 300 352 224 276 148 200 72 124 356 48 280 332 204 256 128 180 52 104 336 28 260 312 184 236 108 160 32 84 316 8 240 292 164 216 88 140 12 64 296 348 220 272 144 196 68 120 352 44 276 328 200 252 124 176 48 100 332 24 256 308 180 232 104 156 28 80 312 4 236 288
ph1 = (360) 103 155 27 79 311 3 235 287 159 211 83 135 7 59 291 343 215 267 139 191 63 115 347 39 271 323 195 247 119 171 43 95 327 19 251 303 175 227 99 151 23 75 307 359 231 283 155 207 79 131 3 55 287 339 211 263 135 187 59 111 343 35 267 319 191 243 115 167 39 91 323 15 247 299 171 223 95 147 19 71 303 355 227 279 151 203 75 127 359 51 283 335 207 259 131 183 55 107 339 31
ph2 = (360) 116 168 40 92 324 16 248 300 172 224 96 148 20 72 304 356 228 280 152 204 76 128 0 52 284 336 208 260 132 184 56 108 340 32 264 316 188 240 112 164 36 88 320 12 244 296 168 220 92 144 16 68 300 352 224 276 148 200 72 124 356 48 280 332 204 256 128 180 52 104 336 28 260 312 184 236 108 160 32 84 316 8 240 292 164 216 88 140 12 64 296 348 220 272 144 196 68 120 352 44
ph3 = (360) 39 91 323 15 247 299 171 223 95 147 19 71 303 355 227 279 151 203 75 127 359 51 283 335 207 259 131 183 55 107 339 31 263 315 187 239 111 163 35 87 319 11 243 295 167 219 91 143 15 67 299 351 223 275 147 199 71 123 355 47 279 331 203 255 127 179 51 103 335 27 259 311 183 235 107 159 31 83 315 7 239 291 163 215 87 139 11 63 295 347 219 271 143 195 67 119 351 43 275 327

ph4 = (360) 90 142 14 66 298 350 222 274 146 198 70 122 354 46 278 330 202 254 126 178 50 102 334 26 258 310 182 234 106 158 30 82 314 6 238 290 162 214 86 138 10 62 294 346 218 270 142 194 66 118 350 42 274 326 198 250 122 174 46 98 330 22 254 306 178 230 102 154 26 78 310 2 234 286 158 210 82 134 6 58 290 342 214 266 138 190 62 114 346 38 270 322 194 246 118 170 42 94 326 18
ph5 = (360) 13 65 297 349 221 273 145 197 69 121 353 45 277 329 201 253 125 177 49 101 333 25 257 309 181 233 105 157 29 81 313 5 237 289 161 213 85 137 9 61 293 345 217 269 141 193 65 117 349 41 273 325 197 249 121 173 45 97 329 21 253 305 177 229 101 153 25 77 309 1 233 285 157 209 81 133 5 57 289 341 213 265 137 189 61 113 345 37 269 321 193 245 117 169 41 93 325 17 249 301
ph6 = (360) 26 78 310 2 234 286 158 210 82 134 6 58 290 342 214 266 138 190 62 114 346 38 270 322 194 246 118 170 42 94 326 18 250 302 174 226 98 150 22 74 306 358 230 282 154 206 78 130 2 54 286 338 210 262 134 186 58 110 342 34 266 318 190 242 114 166 38 90 322 14 246 298 170 222 94 146 18 70 302 354 226 278 150 202 74 126 358 50 282 334 206 258 130 182 54 106 338 30 262 314
ph7 = (360) 129 181 53 105 337 29 261 313 185 237 109 161 33 85 317 9 241 293 165 217 89 141 13 65 297 349 221 273 145 197 69 121 353 45 277 329 201 253 125 177 49 101 333 25 257 309 181 233 105 157 29 81 313 5 237 289 161 213 85 137 9 61 293 345 217 269 141 193 65 117 349 41 273 325 197 249 121 173 45 97 329 21 253 305 177 229 101 153 25 77 309 1 233 285 157 209 81 133 5 57

ph30 = 1 3
ph31 = 0  2
