; 13 January 2022
; Andrew Stasiuk
;
; rZrZ Correlation under periodic kicking
; Discrete Time Crystal Experiments
; Scrambling time variable
; 11 deg Framechange
; theta=180
;
; td1 = N_max , max number of kick & scramble cycles (up to 50)
; NS = 8 (or 16 if desired)

; H_eff = 0

; Peng24 Delays
define delay tau0
"tau0=(d20-p1)/2"
define delay tau1
"tau1=(d20-p1)"

; WAHUHA8 delays
define delay delay0
"delay0=(2*d20-p1)/2"
define delay delay1
"delay1=d20-p1"
define delay delay2
"delay2=(2*d20-p1)"

"l1=0"

1  ze

2   ; state & pp reset delay
    d1 rpp1 rpp2 rpp3 rpp4 rpp6 rpp7 rpp8 rpp9 rpp10 rpp11 rpp12 rpp13 rpp14 rpp15 rpp16 rpp17 rpp19 rpp20 rpp21 rpp22
    100u pl2:f2

; Random Zeeman State Preparation
    (p1 ph0):f2

3   ; Repeated WAHUHA8 to encode random state (18 cycles)
    delay0
    (p1 ph1^):f2
    delay1
    (p1 ph2^):f2
    delay2
    (p1 ph3^):f2
    delay1
    (p1 ph4^):f2
    delay0
    lo to 3 times 36

    (p1 ph5):f2
    2.5u

; Hamiltonian Evolution under Peng24
4   ; periodic kicking & scrambling
    tau0
    (p1 ph6^):f2
    tau1
    (p1 ph7^):f2
    tau1
    (p1 ph8^):f2
    tau1
    (p1 ph9^):f2
    tau1
    (p1 ph10^):f2
    tau1
    (p1 ph11^):f2
    tau1
    (p1 ph12^):f2
    tau1
    (p1 ph13^):f2
    tau1
    (p1 ph14^):f2
    tau1
    (p1 ph15^):f2
    tau1
    (p1 ph16^):f2
    tau1
    (p1 ph17^):f2
    tau0
    lo to 4 times l1

; Random Zeeman Observable Engineering
    (p1 ph18):f2

5   ; Repeated WAHUHA8 to encode random observable (18 cycles)
    delay0
    (p1 ph19^):f2
    delay1
    (p1 ph20^):f2
    delay2
    (p1 ph21^):f2
    delay1
    (p1 ph22^):f2
    delay0
    lo to 5 times 36

    ; shelf in Z, then measure
    (p1 ph23):f2
    1m
    (p1 ph24):f2

    go=2 ph31
    1m wr #0 if #0

    ; increase number of kicking cycles
    5m iu1
    5m iu1

    ; account for extra kicking pulse
    20m ip18*84
    20m ip19*84
    20m ip20*84
    20m ip21*84
    20m ip22*84
    lo to 2 times td1

  exit

ph0 = (360) 270 270 90 90

ph1 = (360) 11 235 99 323 187 51 275 139 3 227 91 315 179 43 267 131 355 219 83 307 171 35 259 123 347 211 75 299 163 27 251 115 339 203 67 291
ph2 = (360) 112 336 200 64 288 152 16 240 104 328 192 56 280 144 8 232 96 320 184 48 272 136 0 224 88 312 176 40 264 128 352 216 80 304 168 32
ph3 = (360) 303 167 31 255 119 343 207 71 295 159 23 247 111 335 199 63 287 151 15 239 103 327 191 55 279 143 7 231 95 319 183 47 271 135 359 223
ph4 = (360) 224 88 312 176 40 264 128 352 216 80 304 168 32 256 120 344 208 72 296 160 24 248 112 336 200 64 288 152 16 240 104 328 192 56 280 144

ph5 = (360) 155 155 155 155 335 335 335 335

ph6 = (360) 76 28 160 112 244 196 328 280 52 4 136 88 220 172 304 256 28 340 112 64 196 148 280 232 4 316 88 40 172 124 256 208 340 292 64 16 148 100 232 184 316 268 40 352 124 76 208 160 292 244 16 328 100 52 184 136 268 220 352 304 76 28 160 112 244 196 328 280 52 4 136 88 220 172 304 256 28 340 112 64 196 148 280 232 4 316 88 40 172 124 256 208 340 292 64 16 148 100 232 184
ph7 = (360) 177 129 261 213 345 297 69 21 153 105 237 189 321 273 45 357 129 81 213 165 297 249 21 333 105 57 189 141 273 225 357 309 81 33 165 117 249 201 333 285 57 9 141 93 225 177 309 261 33 345 117 69 201 153 285 237 9 321 93 45 177 129 261 213 345 297 69 21 153 105 237 189 321 273 45 357 129 81 213 165 297 249 21 333 105 57 189 141 273 225 357 309 81 33 165 117 249 201 333 285
ph8 = (360) 8 320 92 44 176 128 260 212 344 296 68 20 152 104 236 188 320 272 44 356 128 80 212 164 296 248 20 332 104 56 188 140 272 224 356 308 80 32 164 116 248 200 332 284 56 8 140 92 224 176 308 260 32 344 116 68 200 152 284 236 8 320 92 44 176 128 260 212 344 296 68 20 152 104 236 188 320 272 44 356 128 80 212 164 296 248 20 332 104 56 188 140 272 224 356 308 80 32 164 116
ph9 = (360) 289 241 13 325 97 49 181 133 265 217 349 301 73 25 157 109 241 193 325 277 49 1 133 85 217 169 301 253 25 337 109 61 193 145 277 229 1 313 85 37 169 121 253 205 337 289 61 13 145 97 229 181 313 265 37 349 121 73 205 157 289 241 13 325 97 49 181 133 265 217 349 301 73 25 157 109 241 193 325 277 49 1 133 85 217 169 301 253 25 337 109 61 193 145 277 229 1 313 85 37
ph10 = (360) 30 342 114 66 198 150 282 234 6 318 90 42 174 126 258 210 342 294 66 18 150 102 234 186 318 270 42 354 126 78 210 162 294 246 18 330 102 54 186 138 270 222 354 306 78 30 162 114 246 198 330 282 54 6 138 90 222 174 306 258 30 342 114 66 198 150 282 234 6 318 90 42 174 126 258 210 342 294 66 18 150 102 234 186 318 270 42 354 126 78 210 162 294 246 18 330 102 54 186 138
ph11 = (360) 41 353 125 77 209 161 293 245 17 329 101 53 185 137 269 221 353 305 77 29 161 113 245 197 329 281 53 5 137 89 221 173 305 257 29 341 113 65 197 149 281 233 5 317 89 41 173 125 257 209 341 293 65 17 149 101 233 185 317 269 41 353 125 77 209 161 293 245 17 329 101 53 185 137 269 221 353 305 77 29 161 113 245 197 329 281 53 5 137 89 221 173 305 257 29 341 113 65 197 149
ph12 = (360) 322 274 46 358 130 82 214 166 298 250 22 334 106 58 190 142 274 226 358 310 82 34 166 118 250 202 334 286 58 10 142 94 226 178 310 262 34 346 118 70 202 154 286 238 10 322 94 46 178 130 262 214 346 298 70 22 154 106 238 190 322 274 46 358 130 82 214 166 298 250 22 334 106 58 190 142 274 226 358 310 82 34 166 118 250 202 334 286 58 10 142 94 226 178 310 262 34 346 118 70
ph13 = (360) 63 15 147 99 231 183 315 267 39 351 123 75 207 159 291 243 15 327 99 51 183 135 267 219 351 303 75 27 159 111 243 195 327 279 51 3 135 87 219 171 303 255 27 339 111 63 195 147 279 231 3 315 87 39 171 123 255 207 339 291 63 15 147 99 231 183 315 267 39 351 123 75 207 159 291 243 15 327 99 51 183 135 267 219 351 303 75 27 159 111 243 195 327 279 51 3 135 87 219 171
ph14 = (360) 254 206 338 290 62 14 146 98 230 182 314 266 38 350 122 74 206 158 290 242 14 326 98 50 182 134 266 218 350 302 74 26 158 110 242 194 326 278 50 2 134 86 218 170 302 254 26 338 110 62 194 146 278 230 2 314 86 38 170 122 254 206 338 290 62 14 146 98 230 182 314 266 38 350 122 74 206 158 290 242 14 326 98 50 182 134 266 218 350 302 74 26 158 110 242 194 326 278 50 2
ph15 = (360) 175 127 259 211 343 295 67 19 151 103 235 187 319 271 43 355 127 79 211 163 295 247 19 331 103 55 187 139 271 223 355 307 79 31 163 115 247 199 331 283 55 7 139 91 223 175 307 259 31 343 115 67 199 151 283 235 7 319 91 43 175 127 259 211 343 295 67 19 151 103 235 187 319 271 43 355 127 79 211 163 295 247 19 331 103 55 187 139 271 223 355 307 79 31 163 115 247 199 331 283
ph16 = (360) 276 228 0 312 84 36 168 120 252 204 336 288 60 12 144 96 228 180 312 264 36 348 120 72 204 156 288 240 12 324 96 48 180 132 264 216 348 300 72 24 156 108 240 192 324 276 48 0 132 84 216 168 300 252 24 336 108 60 192 144 276 228 0 312 84 36 168 120 252 204 336 288 60 12 144 96 228 180 312 264 36 348 120 72 204 156 288 240 12 324 96 48 180 132 264 216 348 300 72 24
ph17 = (360) 287 59 11 143 95 227 179 311 263 35 347 119 71 203 155 287 239 11 323 95 47 179 131 263 215 347 299 71 23 155 107 239 191 323 275 47 359 131 83 215 167 299 251 23 335 107 59 191 143 275 227 359 311 83 35 167 119 251 203 335 287 59 11 143 95 227 179 311 263 35 347 119 71 203 155 287 239 11 323 95 47 179 131 263 215 347 299 71 23 155 107 239 191 323 275 47 359 131 83 35

ph18 = (360) 166 166 166 166 166 166 166 166 346 346 346 346 346 346 346 346

ph19 = (360) 177 41 265 129 353 217 81 305 169 33 257 121 345 209 73 297 161 25 249 113 337 201 65 289 153 17 241 105 329 193 57 281 145 9 233 97
ph20 = (360) 278 142 6 230 94 318 182 46 270 134 358 222 86 310 174 38 262 126 350 214 78 302 166 30 254 118 342 206 70 294 158 22 246 110 334 198
ph21 = (360) 109 333 197 61 285 149 13 237 101 325 189 53 277 141 5 229 93 317 181 45 269 133 357 221 85 309 173 37 261 125 349 213 77 301 165 29
ph22 = (360) 30 254 118 342 206 70 294 158 22 246 110 334 198 62 286 150 14 238 102 326 190 54 278 142 6 230 94 318 182 46 270 134 358 222 86 310

ph23 = (360) 231 231 51 51

ph24 = 0 2 0 2
ph31 = 1 3 1 3 3 1 3 1 3 1 3 1 1 3 1 3
