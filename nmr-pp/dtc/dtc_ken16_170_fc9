; 15 August 2022
; Andrew Stasiuk
;
; ZZ Correlation under periodic kicking
; Discrete Time Crystal Experiments
; Scrambling time at 120us
; Interaction and Disorder Strength set by Ken16
; theta=170


; cnst1 multiplies disZ, cnst2 multiplies Dz
; H_eff = (1/3)*cnst1*sum(h_i Z_i) + cnst2 * Dz

define delay tau1
"tau1 = d3*(1+cnst1+2*cnst2)-p1/2"
define delay tau2
"tau2 = d3*(1-cnst2)-p1"
define delay tau3
"tau3 = 2*d3*(1-cnst2)-p1"

define delay tau1p
"tau1p = d3*(1-cnst1+2*cnst2)-p1/2"

define delay cycle
"cycle=24*d3"

; First measurement length is 0. Ensure L[1]=0 as well.
"l1=0"

; start the pulse program
1   ze

; reset delay
2   d1 rpp0 rpp1 rpp2 rpp3
    cycle pl2:f2

; Kicking + Ken16
3
    tau1
    (p1 ph0^):f2
    tau2
    (p1 ph1^):f2
    tau3
    (p1 ph2^):f2
    tau2
    (p1 ph3^):f2
    tau1p

    tau1p
    (p1 ph0^):f2
    tau2
    (p1 ph1^):f2
    tau3
    (p1 ph2^):f2
    tau2
    (p1 ph3^):f2
    tau1

    lo to 3 times l1

    ; Measure
    d13
4   (p1 ph30):f2

    go=2 ph31

    1m wr #0 if #0

    ; increase evolution time by 1 cycle length, and re-scan
    1m iu1
    1m iu1
    lo to 2 times td1

    exit

ph0 = (360) 0 36 252 288 334 10 226 262 308 344 200 236 282 318 174 210 256 292 148 184 230 266 122 158 204 240 96 132 178 214 70 106 152 188 44 80 126 162 18 54 100 136 352 28 74 110 326 2 48 84 300 336 22 58 274 310 356 32 248 284 330 6 222 258 304 340 196 232 278 314 170 206 252 288 144 180 226 262 118 154 200 236 92 128 174 210 66 102 148 184 40 76 122 158 14 50 96 132 348 24 70 106 322 358 44 80 296 332 18 54 270 306 352 28 244 280 326 2 218 254 300 336 192 228 274 310 166 202 248 284 140 176 222 258 114 150 196 232 88 124 170 206 62 98 144 180 36 72 118 154 10 46 92 128 344 20 66 102 318 354 40 76 292 328 14 50 266 302 348 24 240 276 322 358 214 250 296 332 188 224 270 306 162 198 244 280 136 172 218 254 110 146 192 228 84 120 166 202 58 94
ph1 = (360) 99 135 351 27 73 109 325 1 47 83 299 335 21 57 273 309 355 31 247 283 329 5 221 257 303 339 195 231 277 313 169 205 251 287 143 179 225 261 117 153 199 235 91 127 173 209 65 101 147 183 39 75 121 157 13 49 95 131 347 23 69 105 321 357 43 79 295 331 17 53 269 305 351 27 243 279 325 1 217 253 299 335 191 227 273 309 165 201 247 283 139 175 221 257 113 149 195 231 87 123 169 205 61 97 143 179 35 71 117 153 9 45 91 127 343 19 65 101 317 353 39 75 291 327 13 49 265 301 347 23 239 275 321 357 213 249 295 331 187 223 269 305 161 197 243 279 135 171 217 253 109 145 191 227 83 119 165 201 57 93 139 175 31 67 113 149 5 41 87 123 339 15 61 97 313 349 35 71 287 323 9 45 261 297 343 19 235 271 317 353 209 245 291 327 183 219 265 301 157 193
ph2 = (360) 108 144 0 36 82 118 334 10 56 92 308 344 30 66 282 318 4 40 256 292 338 14 230 266 312 348 204 240 286 322 178 214 260 296 152 188 234 270 126 162 208 244 100 136 182 218 74 110 156 192 48 84 130 166 22 58 104 140 356 32 78 114 330 6 52 88 304 340 26 62 278 314 0 36 252 288 334 10 226 262 308 344 200 236 282 318 174 210 256 292 148 184 230 266 122 158 204 240 96 132 178 214 70 106 152 188 44 80 126 162 18 54 100 136 352 28 74 110 326 2 48 84 300 336 22 58 274 310 356 32 248 284 330 6 222 258 304 340 196 232 278 314 170 206 252 288 144 180 226 262 118 154 200 236 92 128 174 210 66 102 148 184 40 76 122 158 14 50 96 132 348 24 70 106 322 358 44 80 296 332 18 54 270 306 352 28 244 280 326 2 218 254 300 336 192 228 274 310 166 202
ph3 = (360) 27 63 279 145 1 37 253 119 335 11 227 93 309 345 201 67 283 319 175 41 257 293 149 15 231 267 123 349 205 241 97 323 179 215 71 297 153 189 45 271 127 163 19 245 101 137 353 219 75 111 327 193 49 85 301 167 23 59 275 141 357 33 249 115 331 7 223 89 305 341 197 63 279 315 171 37 253 289 145 11 227 263 119 345 201 237 93 319 175 211 67 293 149 185 41 267 123 159 15 241 97 133 349 215 71 107 323 189 45 81 297 163 19 55 271 137 353 29 245 111 327 3 219 85 301 337 193 59 275 311 167 33 249 285 141 7 223 259 115 341 197 233 89 315 171 207 63 289 145 181 37 263 119 155 11 237 93 129 345 211 67 103 319 185 41 77 293 159 15 51 267 133 349 25 241 107 323 359 215 81 297 333 189 55 271 307 163 29 245 281 137 3 219 255 111 337 193 229 85 121s

ph30 = 1 3 3 1
ph31 = 0 2 2 0
