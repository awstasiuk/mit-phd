; 22 November 2022
; Andrew Stasiuk
;
; DzDz Correlation under periodic kicking
; Discrete Time Crystal Experiments
; Scrambling time at 120us
; Interaction and Disorder Strength set by Ken16
; theta=170


; cnst1 multiplies disZ, cnst2 multiplies Dz
; coupling strengths precompiled into delay lists
; H_eff = (1/3)*cnst1*sum(h_i Z_i) + cnst2 * Dz

define list<delay> tau1 = {0.00000449 0.00000499 0.00000549 0.00000599 0.00000649 0.00000699 0.00000749}
define list<delay> tau2 = {0.00000398 0.00000373 0.00000348 0.00000323 0.00000298 0.00000273 0.00000248}
define list<delay> tau3 = {0.00000898 0.00000848 0.00000798 0.00000748 0.00000698 0.00000648 0.00000598}
define list<delay> tau1p = {0.00000449 0.00000499 0.00000549 0.00000599 0.00000649 0.00000699 0.00000749}

define delay cycle
"cycle=24*d3"

; td2 = n_max
; td1 = 11

; First measurement length is 0. Ensure L[1]=0 as well.
"l1=0"

; start the pulse program
1   ze

; reset delay
2   d1 rpp2 rpp3 rpp4 rpp5 rpp6 rpp7 rpp8 rpp9
    cycle pl2:f2

    (p1 ph0):f2
    d2
    (p2 ph1):f2
    1m


; Kicking + Ken16
3
    tau1
    (p1 ph2^):f2
    tau2
    (p1 ph3^):f2
    tau3
    (p1 ph4^):f2
    tau2
    (p1 ph5^):f2
    tau1p

    tau1p
    (p1 ph6^):f2
    tau2
    (p1 ph7^):f2
    tau3
    (p1 ph8^):f2
    tau2
    (p1 ph9^):f2
    tau1

    lo to 3 times l1

    ; Measure
    1m
4   (p2 ph30):f2

    go=2 ph31

    1m wr #0 if #0

    ; increase evolution time by 1 cycle length, and re-scan
    1m iu1
    1m iu1
    lo to 2 times td2

    5m ru1
    5m tau1.inc
    5m tau2.inc
    5m tau3.inc
    5m tau1p.inc
    lo to 2 times td1

    exit

ph0 = (360) 348 348 168 168
ph1 = 1 1 3 3

ph2 = (360) 0 276 22 298 44 320 66 342 88 4 110 26 132 48 154 70 176 92 198 114 220 136 242 158 264 180 286 202 308 224 330 246 352 268 14 290 36 312 58 334 80 356 102 18 124 40 146 62 168 84 190 106 212 128 234 150 256 172 278 194 300 216 322 238 344 260 6 282 28 304 50 326 72 348 94 10 116 32 138 54 160 76 182 98 204 120 226 142 248 164 270 186 292 208 314 230 336 252 358 274 20 296 42 318 64 340 86 2 108 24 130 46 152 68 174 90 196 112 218 134 240 156 262 178 284 200 306 222 328 244 350 266 12 288 34 310 56 332 78 354 100 16 122 38 144 60 166 82 188 104 210 126 232 148 254 170 276 192 298 214 320 236 342 258 4 280 26 302 48 324 70 346 92 8 114 30 136 52 158 74 180 96 202 118 224 140 246 162 268 184 290 206 312 228 334 250 356 272 18 294
ph3 = (360) 102 18 124 40 146 62 168 84 190 106 212 128 234 150 256 172 278 194 300 216 322 238 344 260 6 282 28 304 50 326 72 348 94 10 116 32 138 54 160 76 182 98 204 120 226 142 248 164 270 186 292 208 314 230 336 252 358 274 20 296 42 318 64 340 86 2 108 24 130 46 152 68 174 90 196 112 218 134 240 156 262 178 284 200 306 222 328 244 350 266 12 288 34 310 56 332 78 354 100 16 122 38 144 60 166 82 188 104 210 126 232 148 254 170 276 192 298 214 320 236 342 258 4 280 26 302 48 324 70 346 92 8 114 30 136 52 158 74 180 96 202 118 224 140 246 162 268 184 290 206 312 228 334 250 356 272 18 294 40 316 62 338 84 0 106 22 128 44 150 66 172 88 194 110 216 132 238 154 260 176 282 198 304 220 326 242 348 264 10 286 32 308 54 330 76 352 98 14 120 36
ph4 = (360) 114 30 136 52 158 74 180 96 202 118 224 140 246 162 268 184 290 206 312 228 334 250 356 272 18 294 40 316 62 338 84 0 106 22 128 44 150 66 172 88 194 110 216 132 238 154 260 176 282 198 304 220 326 242 348 264 10 286 32 308 54 330 76 352 98 14 120 36 142 58 164 80 186 102 208 124 230 146 252 168 274 190 296 212 318 234 340 256 2 278 24 300 46 322 68 344 90 6 112 28 134 50 156 72 178 94 200 116 222 138 244 160 266 182 288 204 310 226 332 248 354 270 16 292 38 314 60 336 82 358 104 20 126 42 148 64 170 86 192 108 214 130 236 152 258 174 280 196 302 218 324 240 346 262 8 284 30 306 52 328 74 350 96 12 118 34 140 56 162 78 184 100 206 122 228 144 250 166 272 188 294 210 316 232 338 254 0 276 22 298 44 320 66 342 88 4 110 26 132 48
ph5 = (360) 36 312 58 334 80 356 102 18 124 40 146 62 168 84 190 106 212 128 234 150 256 172 278 194 300 216 322 238 344 260 6 282 28 304 50 326 72 348 94 10 116 32 138 54 160 76 182 98 204 120 226 142 248 164 270 186 292 208 314 230 336 252 358 274 20 296 42 318 64 340 86 2 108 24 130 46 152 68 174 90 196 112 218 134 240 156 262 178 284 200 306 222 328 244 350 266 12 288 34 310 56 332 78 354 100 16 122 38 144 60 166 82 188 104 210 126 232 148 254 170 276 192 298 214 320 236 342 258 4 280 26 302 48 324 70 346 92 8 114 30 136 52 158 74 180 96 202 118 224 140 246 162 268 184 290 206 312 228 334 250 356 272 18 294 40 316 62 338 84 0 106 22 128 44 150 66 172 88 194 110 216 132 238 154 260 176 282 198 304 220 326 242 348 264 10 286 32 308 54 330
ph6 = (360) 48 324 70 346 92 8 114 30 136 52 158 74 180 96 202 118 224 140 246 162 268 184 290 206 312 228 334 250 356 272 18 294 40 316 62 338 84 0 106 22 128 44 150 66 172 88 194 110 216 132 238 154 260 176 282 198 304 220 326 242 348 264 10 286 32 308 54 330 76 352 98 14 120 36 142 58 164 80 186 102 208 124 230 146 252 168 274 190 296 212 318 234 340 256 2 278 24 300 46 322 68 344 90 6 112 28 134 50 156 72 178 94 200 116 222 138 244 160 266 182 288 204 310 226 332 248 354 270 16 292 38 314 60 336 82 358 104 20 126 42 148 64 170 86 192 108 214 130 236 152 258 174 280 196 302 218 324 240 346 262 8 284 30 306 52 328 74 350 96 12 118 34 140 56 162 78 184 100 206 122 228 144 250 166 272 188 294 210 316 232 338 254 0 276 22 298 44 320 66 342
ph7 = (360) 150 66 172 88 194 110 216 132 238 154 260 176 282 198 304 220 326 242 348 264 10 286 32 308 54 330 76 352 98 14 120 36 142 58 164 80 186 102 208 124 230 146 252 168 274 190 296 212 318 234 340 256 2 278 24 300 46 322 68 344 90 6 112 28 134 50 156 72 178 94 200 116 222 138 244 160 266 182 288 204 310 226 332 248 354 270 16 292 38 314 60 336 82 358 104 20 126 42 148 64 170 86 192 108 214 130 236 152 258 174 280 196 302 218 324 240 346 262 8 284 30 306 52 328 74 350 96 12 118 34 140 56 162 78 184 100 206 122 228 144 250 166 272 188 294 210 316 232 338 254 0 276 22 298 44 320 66 342 88 4 110 26 132 48 154 70 176 92 198 114 220 136 242 158 264 180 286 202 308 224 330 246 352 268 14 290 36 312 58 334 80 356 102 18 124 40 146 62 168 84
ph8 = (360) 162 78 184 100 206 122 228 144 250 166 272 188 294 210 316 232 338 254 0 276 22 298 44 320 66 342 88 4 110 26 132 48 154 70 176 92 198 114 220 136 242 158 264 180 286 202 308 224 330 246 352 268 14 290 36 312 58 334 80 356 102 18 124 40 146 62 168 84 190 106 212 128 234 150 256 172 278 194 300 216 322 238 344 260 6 282 28 304 50 326 72 348 94 10 116 32 138 54 160 76 182 98 204 120 226 142 248 164 270 186 292 208 314 230 336 252 358 274 20 296 42 318 64 340 86 2 108 24 130 46 152 68 174 90 196 112 218 134 240 156 262 178 284 200 306 222 328 244 350 266 12 288 34 310 56 332 78 354 100 16 122 38 144 60 166 82 188 104 210 126 232 148 254 170 276 192 298 214 320 236 342 258 4 280 26 302 48 324 70 346 92 8 114 30 136 52 158 74 180 96
ph9 = (360) 84 190 106 212 128 234 150 256 172 278 194 300 216 322 238 344 260 6 282 28 304 50 326 72 348 94 10 116 32 138 54 160 76 182 98 204 120 226 142 248 164 270 186 292 208 314 230 336 252 358 274 20 296 42 318 64 340 86 2 108 24 130 46 152 68 174 90 196 112 218 134 240 156 262 178 284 200 306 222 328 244 350 266 12 288 34 310 56 332 78 354 100 16 122 38 144 60 166 82 188 104 210 126 232 148 254 170 276 192 298 214 320 236 342 258 4 280 26 302 48 324 70 346 92 8 114 30 136 52 158 74 180 96 202 118 224 140 246 162 268 184 290 206 312 228 334 250 356 272 18 294 40 316 62 338 84 0 106 22 128 44 150 66 172 88 194 110 216 132 238 154 260 176 282 198 304 220 326 242 348 264 10 286 32 308 54 330 76 352 98 14 120 36 142 58 164 80 186 102 18

ph30 = 1 3 1 3
ph31 = 0 2 0 2
