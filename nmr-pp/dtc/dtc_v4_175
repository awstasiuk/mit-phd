; 24 June 2022
; Andrew Stasiuk
;
; ZZ Correlation under periodic kicking
; Discrete Time Crystal Experiments, version 4
; Scrambling time at 120us
; Interaction and Disorder Strength set by Ken16
; theta=175
; Framechange=10


; cnst1 multiplies disZ, cnst2 multiplies Dz
; H_eff = (1/3)*cnst1*sum(h_i Z_i) + cnst2 * Dz

define delay tau1
"tau1 = d3*(1+cnst1+2*cnst2)-p1/2"
define delay tau2
"tau2 = d3*(1-cnst2)-p1"
define delay tau3
"tau3 = 2*d3*(1-cnst2)-p1"

define delay tau1p
"tau1p = d3*(1-cnst1+2*cnst2)-p1/2"
define delay tau2p
"tau2p = d3*(1-cnst2)-p1"
define delay tau3p
"tau3p = 2*d3*(1-cnst2)-p1"

define delay cycle
"cycle=24*d3"

; First measurement length is 0. Ensure L[1]=0 as well.
"l1=0"

; start the pulse program
1   ze

; reset delay
2   d1 rpp10 rpp11 rpp12 rpp13 rpp20 rpp21
    cycle pl2:f2

; Kicking + Ken16
3
    (p1 ph20^):f2
    2.5u
    (p1 ph21^):f2

    tau1
    (p1 ph10^):f2
    tau2
    (p1 ph10^):f2
    tau3
    (p1 ph10^):f2
    tau2p
    (p1 ph10^):f2
    tau1p

    tau1p
    (p1 ph11^):f2
    tau2
    (p1 ph11^):f2
    tau3p
    (p1 ph11^):f2
    tau2p
    (p1 ph11^):f2
    tau1

    tau1
    (p1 ph12^):f2
    tau2p
    (p1 ph12^):f2
    tau3p
    (p1 ph12^):f2
    tau2
    (p1 ph12^):f2
    tau1p

    tau1p
    (p1 ph13^):f2
    tau2p
    (p1 ph13^):f2
    tau3
    (p1 ph13^):f2
    tau2
    (p1 ph13^):f2
    tau1

    lo to 3 times l1

    ; Measure
    d13
4   (p1 ph6):f2

    go=2 ph31

    1m wr #0 if #0

    ; increase evolution time by 1 cycle length, and re-scan
    1m iu1
    lo to 2 times td2

    ; Average over many instances of disorder.
    1m ru1
    lo to 2 times td1

    exit


; Ken16 phase programs
ph10 = (360) 185 285 295 215 190 290 300 220 195 295 305 225 200 300 310 230 205 305 315 235 210 310 320 240 215 315 325 245 220 320 330 250 225 325 335 255 230 330 340 260 235 335 345 265 240 340 350 270 245 345 355 275 250 350 0 280 255 355 5 285 260 0 10 290 265 5 15 295 270 10 20 300 275 15 25 305 280 20 30 310 285 25 35 315 290 30 40 320 295 35 45 325 300 40 50 330 305 45 55 335 310 50 60 340 315 55 65 345 320 60 70 350 325 65 75 355 330 70 80 0 335 75 85 5 340 80 90 10 345 85 95 15 350 90 100 20 355 95 105 25 0 100 110 30 5 105 115 35 10 110 120 40 15 115 125 45 20 120 130 50 25 125 135 55 30 130 140 60 35 135 145 65 40 140 150 70 45 145 155 75 50 150 160 80 55 155 165 85 60 160 170 90 65 165 175 95 70 170 180 100
ph11 = (360) 225 325 335 255 230 330 340 260 235 335 345 265 240 340 350 270 245 345 355 275 250 350 0 280 255 355 5 285 260 0 10 290 265 5 15 295 270 10 20 300 275 15 25 305 280 20 30 310 285 25 35 315 290 30 40 320 295 35 45 325 300 40 50 330 305 45 55 335 310 50 60 340 315 55 65 345 320 60 70 350 325 65 75 355 330 70 80 0 335 75 85 5 340 80 90 10 345 85 95 15 350 90 100 20 355 95 105 25 0 100 110 30 5 105 115 35 10 110 120 40 15 115 125 45 20 120 130 50 25 125 135 55 30 130 140 60 35 135 145 65 40 140 150 70 45 145 155 75 50 150 160 80 55 155 165 85 60 160 170 90 65 165 175 95 70 170 180 100 75 175 185 105 80 180 190 110 85 185 195 115 90 190 200 120 95 195 205 125 100 200 210 130 105 205 215 135 110 210 220 140
ph12 = (360) 85 185 195 115 90 190 200 120 95 195 205 125 100 200 210 130 105 205 215 135 110 210 220 140 115 215 225 145 120 220 230 150 125 225 235 155 130 230 240 160 135 235 245 165 140 240 250 170 145 245 255 175 150 250 260 180 155 255 265 185 160 260 270 190 165 265 275 195 170 270 280 200 175 275 285 205 180 280 290 210 185 285 295 215 190 290 300 220 195 295 305 225 200 300 310 230 205 305 315 235 210 310 320 240 215 315 325 245 220 320 330 250 225 325 335 255 230 330 340 260 235 335 345 265 240 340 350 270 245 345 355 275 250 350 0 280 255 355 5 285 260 0 10 290 265 5 15 295 270 10 20 300 275 15 25 305 280 20 30 310 285 25 35 315 290 30 40 320 295 35 45 325 300 40 50 330 305 45 55 335 310 50 60 340 315 55 65 345 320 60 70 350 325 65 75 355 330 70 80 0
ph13 = (360) 125 225 235 155 130 230 240 160 135 235 245 165 140 240 250 170 145 245 255 175 150 250 260 180 155 255 265 185 160 260 270 190 165 265 275 195 170 270 280 200 175 275 285 205 180 280 290 210 185 285 295 215 190 290 300 220 195 295 305 225 200 300 310 230 205 305 315 235 210 310 320 240 215 315 325 245 220 320 330 250 225 325 335 255 230 330 340 260 235 335 345 265 240 340 350 270 245 345 355 275 250 350 0 280 255 355 5 285 260 0 10 290 265 5 15 295 270 10 20 300 275 15 25 305 280 20 30 310 285 25 35 315 290 30 40 320 295 35 45 325 300 40 50 330 305 45 55 335 310 50 60 340 315 55 65 345 320 60 70 350 325 65 75 355 330 70 80 0 335 75 85 5 340 80 90 10 345 85 95 15 350 90 100 20 355 95 105 25 0 100 110 30 5 105 115 35 10 110 120 40

; Rx(theta) Phase Program
ph20 = (360) 70 75 80 85 90 95 100 105 110 115 120 125 130 135 140 145 150 155 160 165 170 175 180 185 190 195 200 205 210 215 220 225 230 235 240 245 250 255 260 265 270 275 280 285 290 295 300 305 310 315
ph21 = (360) 85 90 95 100 105 110 115 120 125 130 135 140 145 150 155 160 165 170 175 180 185 190 195 200 205 210 215 220 225 230 235 240 245 250 255 260 265 270 275 280 285 290 295 300 305 310 315 320 325 330

ph6 = 1 3
ph31 = 0 2
