; 31 August 2022
; Andrew Stasiuk
;
; rZrZ Correlation under periodic kicking
; Discrete Time Crystal Experiments
; Scrambling time variable
; 8 deg Framechange
; theta=170
;
; td2 = N_max , max number of kick & scramble cycles (up to 50)
; td1 = length of scramble list, variable Dz scrambling delays
; NS = 8 (or 16 if desired)

; cnst1 multiplies disZ, cnst2 multiplies Dz
; coupling strengths precompiled into delay lists
; H_eff = (1/3)*cnst1*sum(h_i Z_i) + cnst2 * Dz

define list<delay> tau1 = {0.00000599 0.00000649 0.00000699 0.00000749 0.00000799 0.00000849 0.00000949 0.00000999 0.00001049 0.00001099}
define list<delay> tau2 = {0.00000398 0.00000373 0.00000348 0.00000323 0.00000298 0.00000273 0.00000223 0.00000198 0.00000173 0.00000148}
define list<delay> tau3 = {0.00000898 0.00000848 0.00000798 0.00000748 0.00000698 0.00000648 0.00000548 0.00000498 0.00000448 0.00000398}

define list<delay> tau1p = {0.00000299 0.00000349 0.00000399 0.00000449 0.00000499 0.00000549 0.00000649 0.00000699 0.00000749 0.00000799}


; WAHUHA8 delays
define delay delay0
"delay0=(2*d20-p1)/2"
define delay delay1
"delay1=d20-p1"
define delay delay2
"delay2=(2*d20-p1)"

"l1=0"

1  ze

2   ; state & pp reset delay
    d1 rpp1 rpp2 rpp3 rpp4 rpp6 rpp7 rpp8 rpp9 rpp10 rpp11 rpp12 rpp13 rpp15 rpp16 rpp17 rpp18
    100u pl2:f2

; Random Zeeman State Preparation
    (p1 ph0):f2

3   ; Repeated WAHUHA8 to encode random state (18 cycles)
    delay0
    (p1 ph1^):f2
    delay1
    (p1 ph2^):f2
    delay2
    (p1 ph3^):f2
    delay1
    (p1 ph4^):f2
    delay0
    lo to 3 times 36

    (p1 ph5):f2
    2.5u

; Hamiltonian Evolution under Ken16
4   ; periodic kicking & scrambling
    tau1
    (p1 ph6^):f2
    tau2
    (p1 ph7^):f2
    tau3
    (p1 ph8^):f2
    tau2
    (p1 ph9^):f2
    tau1p

    tau1p
    (p1 ph10^):f2
    tau2
    (p1 ph11^):f2
    tau3
    (p1 ph12^):f2
    tau2
    (p1 ph13^):f2
    tau1

    lo to 4 times l1

; Random Zeeman Observable Engineering
    (p1 ph14):f2

5   ; Repeated WAHUHA8 to encode random observable (18 cycles)
    delay0
    (p1 ph15^):f2
    delay1
    (p1 ph16^):f2
    delay2
    (p1 ph17^):f2
    delay1
    (p1 ph18^):f2
    delay0
    lo to 5 times 36

    ; shelf in Z, then measure
    (p1 ph19):f2
    1m
    (p1 ph20):f2

    go=2 ph31
    1m wr #0 if #0

    ; increase number of kicking cycles
    5m iu1
    5m iu1

    ; account for extra kicking pulse
    25m ip14*138
    25m ip15*138
    25m ip16*138
    25m ip17*138
    25m ip18*138
    25m ip19*138
    lo to 2 times td2

    ; increment scrambling constants, reset phase programs
    5m tau1.inc
    5m tau2.inc
    5m tau3.inc
    5m tau1p.inc

    25m rp14
    25m rp15
    25m rp16
    25m rp17
    25m rp18
    25m rp19

    5m ru1
    lo to 2 times td1

  exit

  ph0 = (360) 270 270 90 90

  ph1 = (360) 8 220 72 284 136 348 200 52 264 116 328 180 32 244 96 308 160 12 224 76 288 140 352 204 56 268 120 332 184 36 248 100 312 164 16 228
  ph2 = (360) 106 318 170 22 234 86 298 150 2 214 66 278 130 342 194 46 258 110 322 174 26 238 90 302 154 6 218 70 282 134 346 198 50 262 114 326
  ph3 = (360) 294 146 358 210 62 274 126 338 190 42 254 106 318 170 22 234 86 298 150 2 214 66 278 130 342 194 46 258 110 322 174 26 238 90 302 154
  ph4 = (360) 212 64 276 128 340 192 44 256 108 320 172 24 236 88 300 152 4 216 68 280 132 344 196 48 260 112 324 176 28 240 92 304 156 8 220 72

  ph5 = (360) 80 80 80 80 260 260 260 260

  ph6 = (360) 268 152 46 290 184 68 322 206 100 344 238 122 16 260 154 38 292 176 70 314 208 92 346 230 124 8 262 146 40 284 178 62 316 200 94 338 232 116 10 254 148 32 286 170 64 308 202 86 340 224 118 2 256 140 34 278 172 56 310 194 88 332 226 110 4 248 142 26 280 164 58 302 196 80 334 218 112 356 250 134 28 272 166 50 304 188 82 326 220 104 358 242 136 20 274 158 52 296 190 74
  ph7 = (360) 6 250 144 28 282 166 60 304 198 82 336 220 114 358 252 136 30 274 168 52 306 190 84 328 222 106 0 244 138 22 276 160 54 298 192 76 330 214 108 352 246 130 24 268 162 46 300 184 78 322 216 100 354 238 132 16 270 154 48 292 186 70 324 208 102 346 240 124 18 262 156 40 294 178 72 316 210 94 348 232 126 10 264 148 42 286 180 64 318 202 96 340 234 118 12 256 150 34 288 172
  ph8 = (360) 14 258 152 36 290 174 68 312 206 90 344 228 122 6 260 144 38 282 176 60 314 198 92 336 230 114 8 252 146 30 284 168 62 306 200 84 338 222 116 0 254 138 32 276 170 54 308 192 86 330 224 108 2 246 140 24 278 162 56 300 194 78 332 216 110 354 248 132 26 270 164 48 302 186 80 324 218 102 356 240 134 18 272 156 50 294 188 72 326 210 104 348 242 126 20 264 158 42 296 180
  ph9 = (360) 292 176 70 314 208 92 346 230 124 8 262 146 40 284 178 62 316 200 94 338 232 116 10 254 148 32 286 170 64 308 202 86 340 224 118 2 256 140 34 278 172 56 310 194 88 332 226 110 4 248 142 26 280 164 58 302 196 80 334 218 112 356 250 134 28 272 166 50 304 188 82 326 220 104 358 242 136 20 274 158 52 296 190 74 328 212 106 350 244 128 22 266 160 44 298 182 76 320 214 98
  ph10 = (360) 300 184 78 322 216 100 354 238 132 16 270 154 48 292 186 70 324 208 102 346 240 124 18 262 156 40 294 178 72 316 210 94 348 232 126 10 264 148 42 286 180 64 318 202 96 340 234 118 12 256 150 34 288 172 66 310 204 88 342 226 120 4 258 142 36 280 174 58 312 196 90 334 228 112 6 250 144 28 282 166 60 304 198 82 336 220 114 358 252 136 30 274 168 52 306 190 84 328 222 106
  ph11 = (360) 38 282 176 60 314 198 92 336 230 114 8 252 146 30 284 168 62 306 200 84 338 222 116 0 254 138 32 276 170 54 308 192 86 330 224 108 2 246 140 24 278 162 56 300 194 78 332 216 110 354 248 132 26 270 164 48 302 186 80 324 218 102 356 240 134 18 272 156 50 294 188 72 326 210 104 348 242 126 20 264 158 42 296 180 74 318 212 96 350 234 128 12 266 150 44 288 182 66 320 204
  ph12 = (360) 46 290 184 68 322 206 100 344 238 122 16 260 154 38 292 176 70 314 208 92 346 230 124 8 262 146 40 284 178 62 316 200 94 338 232 116 10 254 148 32 286 170 64 308 202 86 340 224 118 2 256 140 34 278 172 56 310 194 88 332 226 110 4 248 142 26 280 164 58 302 196 80 334 218 112 356 250 134 28 272 166 50 304 188 82 326 220 104 358 242 136 20 274 158 52 296 190 74 328 212
  ph13 = (360) 324 38 102 176 240 314 18 92 156 230 294 8 72 146 210 284 348 62 126 200 264 338 42 116 180 254 318 32 96 170 234 308 12 86 150 224 288 2 66 140 204 278 342 56 120 194 258 332 36 110 174 248 312 26 90 164 228 302 6 80 144 218 282 356 60 134 198 272 336 50 114 188 252 326 30 104 168 242 306 20 84 158 222 296 0 74 138 212 276 350 54 128 192 266 330 44 108 182 246 130

  ph14 = (360) 88 88 88 88 88 88 88 88 268 268 268 268 268 268 268 268

  ph15 = (360) 96 308 160 12 224 76 288 140 352 204 56 268 120 332 184 36 248 100 312 164 16 228 80 292 144 356 208 60 272 124 336 188 40 252 104 316
  ph16 = (360) 194 46 258 110 322 174 26 238 90 302 154 6 218 70 282 134 346 198 50 262 114 326 178 30 242 94 306 158 10 222 74 286 138 350 202 54
  ph17 = (360) 22 234 86 298 150 2 214 66 278 130 342 194 46 258 110 322 174 26 238 90 302 154 6 218 70 282 134 346 198 50 262 114 326 178 30 242
  ph18 = (360) 300 152 4 216 68 280 132 344 196 48 260 112 324 176 28 240 92 304 156 8 220 72 284 136 348 200 52 264 116 328 180 32 244 96 308 160

  ph19 = (360) 78 78 258 258

  ph20 = 0 2 0 2
  ph31 = 1 3 1 3 3 1 3 1 3 1 3 1 1 3 1 3
