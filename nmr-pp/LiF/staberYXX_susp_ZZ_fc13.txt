; STABER sequence test (name pending)
; discovered by lance berkey
; 10 July 2024

; delays
define delay delay0
"delay0=(d20-p1)/2"
define delay delay1
"delay1=d20-p1"
"l1=0"

1  ze

2   ; state & pp reset delay
    d1 rpp0 rpp1 rpp2 rpp3
    100u pl2:f2

3   ; sequence
    delay0
    (p1 ph0^):f2
    delay1
    (p1 ph1^):f2
    delay1
    (p1 ph2^):f2
    delay1
    (p1 ph3^):f2
    delay0

    delay0
    (p1 ph0^):f2
    delay1
    (p1 ph1^):f2
    delay1
    (p1 ph2^):f2
    delay1
    (p1 ph3^):f2
    delay0

    delay0
    (p1 ph0^):f2
    delay1
    (p1 ph1^):f2
    delay1
    (p1 ph2^):f2
    delay1
    (p1 ph3^):f2
    delay0
    
    lo to 3 times l1

    ; kill transients
    1m

    ; measure
    (p1 ph29):f2
    20u
    (p1 ph30):f2

    go=2 ph31
    1m wr #0 if #0

    ; increase evolution time by 2 cycle length, and re-scan
    1m iu1
    1m iu1
    lo to 2 times td1

    exit


; phase programs
ph0 = (360) 90 52 194 336 28 260 42 4 146 288 340 212 354 316 98 240 292 164 306 268 50 192 244 116 258 220 2 144 196 68 210 172 314 96 148 20 162 124 266 48 100 332 114 76 218 0 52 284 66 28 170 312 4 236 18 340 122 264 316 188 330 292 74 216 268 140 282 244 26 168 220 92 234 196 338 120 172 44 186 148 290 72 124 356 138 100 242 24 76 308 90 52 194 336 28 260 42 4 146 288 340 212 354 316 98 240 292 164 306 268 50 192 244 116 258 220 2 144 196 68 210 172 314 96 148 20 162 124 266 48 100 332 114 76 218 0 52 284 66 28 170 312 4 236 18 340 122 264 316 188 330 292 74 216 268 140 282 244 26 168 220 92 234 196 338 120 172 44 186 148 290 72 124 356 138 100 242 24 76 308
ph1 = (360) 13 65 297 349 131 183 325 17 249 301 83 135 277 329 201 253 35 87 229 281 153 205 347 39 181 233 105 157 299 351 133 185 57 109 251 303 85 137 9 61 203 255 37 89 321 13 155 207 349 41 273 325 107 159 301 353 225 277 59 111 253 305 177 229 11 63 205 257 129 181 323 15 157 209 81 133 275 327 109 161 33 85 227 279 61 113 345 37 179 231 13 65 297 349 131 183 325 17 249 301 83 135 277 329 201 253 35 87 229 281 153 205 347 39 181 233 105 157 299 351 133 185 57 109 251 303 85 137 9 61 203 255 37 89 321 13 155 207 349 41 273 325 107 159 301 353 225 277 59 111 253 305 177 229 11 63 205 257 129 181 323 15 157 209 81 133 275 327 109 161 33 85 227 279 61 113 345 37 179 231
ph2 = (360) 26 258 310 272 324 286 338 210 262 224 276 238 290 162 214 176 228 190 242 114 166 128 180 142 194 66 118 80 132 94 146 18 70 32 84 46 98 330 22 344 36 358 50 282 334 296 348 310 2 234 286 248 300 262 314 186 238 200 252 214 266 138 190 152 204 166 218 90 142 104 156 118 170 42 94 56 108 70 122 354 46 8 60 22 74 306 358 320 12 334 26 258 310 272 324 286 338 210 262 224 276 238 290 162 214 176 228 190 242 114 166 128 180 142 194 66 118 80 132 94 146 18 70 32 84 46 98 330 22 344 36 358 50 282 334 296 348 310 2 234 286 248 300 262 314 186 238 200 252 214 266 138 190 152 204 166 218 90 142 104 156 118 170 42 94 56 108 70 122 354 46 8 60 22 74 306 358 320 12 334
ph3 = (360) 309 271 53 15 247 299 261 223 5 327 199 251 213 175 317 279 151 203 165 127 269 231 103 155 117 79 221 183 55 107 69 31 173 135 7 59 21 343 125 87 319 11 333 295 77 39 271 323 285 247 29 351 223 275 237 199 341 303 175 227 189 151 293 255 127 179 141 103 245 207 79 131 93 55 197 159 31 83 45 7 149 111 343 35 357 319 101 63 295 347 309 271 53 15 247 299 261 223 5 327 199 251 213 175 317 279 151 203 165 127 269 231 103 155 117 79 221 183 55 107 69 31 173 135 7 59 21 343 125 87 319 11 333 295 77 39 271 323 285 247 29 351 223 275 237 199 341 303 175 227 189 151 293 255 127 179 141 103 245 207 79 131 93 55 197 159 31 83 45 7 149 111 343 35 357 319 101 63 295 347

; measurement sequence for solid echo
ph29 = 0 2
ph30 = 1 3
ph31 = 0 2