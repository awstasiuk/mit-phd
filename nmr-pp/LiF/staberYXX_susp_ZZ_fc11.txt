; STABER sequence test (name pending)
; discovered by lance berkey
; 10 July 2024

; delays
define delay delay0
"delay0=(d20-p1)/2"
define delay delay1
"delay1=d20-p1"
"l1=0"

1  ze

2   ; state & pp reset delay
    d1 rpp0 rpp1 rpp2 rpp3
    100u pl2:f2

3   ; sequence
    delay0
    (p1 ph0^):f2
    delay1
    (p1 ph1^):f2
    delay1
    (p1 ph2^):f2
    delay1
    (p1 ph3^):f2
    delay0

    delay0
    (p1 ph0^):f2
    delay1
    (p1 ph1^):f2
    delay1
    (p1 ph2^):f2
    delay1
    (p1 ph3^):f2
    delay0

    delay0
    (p1 ph0^):f2
    delay1
    (p1 ph1^):f2
    delay1
    (p1 ph2^):f2
    delay1
    (p1 ph3^):f2
    delay0
    
    lo to 3 times l1

    ; kill transients
    1m

    ; measure
    (p1 ph29):f2
    20u
    (p1 ph30):f2

    go=2 ph31
    1m wr #0 if #0

    ; increase evolution time by 2 cycle length, and re-scan
    1m iu1
    1m iu1
    lo to 2 times td1

    exit

; phase programs
ph0 = (360) 90 44 178 312 356 220 354 308 82 216 260 124 258 212 346 120 164 28 162 116 250 24 68 292 66 20 154 288 332 196 330 284 58 192 236 100 234 188 322 96 140 4 138 92 226 0 44 268 42 356 130 264 308 172 306 260 34 168 212 76 210 164 298 72 116 340 114 68 202 336 20 244 18 332 106 240 284 148 282 236 10 144 188 52 186 140 274 48 92 316 90 44 178 312 356 220 354 308 82 216 260 124 258 212 346 120 164 28 162 116 250 24 68 292 66 20 154 288 332 196 330 284 58 192 236 100 234 188 322 96 140 4 138 92 226 0 44 268 42 356 130 264 308 172 306 260 34 168 212 76 210 164 298 72 116 340 114 68 202 336 20 244 18 332 106 240 284 148 282 236 10 144 188 52 186 140 274 48 92 316 90 44 178 312 356 220 354 308 82 216 260 124 258 212 346 120 164 28 162 116 250 24 68 292 66 20 154 288 332 196 330 284 58 192 236 100 234 188 322 96 140 4 138 92 226 0 44 268 42 356 130 264 308 172 306 260 34 168 212 76 210 164 298 72 116 340 114 68 202 336 20 244 18 332 106 240 284 148 282 236 10 144 188 52 186 140 274 48 92 316 90 44 178 312 356 220 354 308 82 216 260 124 258 212 346 120 164 28 162 116 250 24 68 292 66 20 154 288 332 196
ph1 = (360) 11 55 279 323 97 141 275 319 183 227 1 45 179 223 87 131 265 309 83 127 351 35 169 213 347 31 255 299 73 117 251 295 159 203 337 21 155 199 63 107 241 285 59 103 327 11 145 189 323 7 231 275 49 93 227 271 135 179 313 357 131 175 39 83 217 261 35 79 303 347 121 165 299 343 207 251 25 69 203 247 111 155 289 333 107 151 15 59 193 237 11 55 279 323 97 141 275 319 183 227 1 45 179 223 87 131 265 309 83 127 351 35 169 213 347 31 255 299 73 117 251 295 159 203 337 21 155 199 63 107 241 285 59 103 327 11 145 189 323 7 231 275 49 93 227 271 135 179 313 357 131 175 39 83 217 261 35 79 303 347 121 165 299 343 207 251 25 69 203 247 111 155 289 333 107 151 15 59 193 237 11 55 279 323 97 141 275 319 183 227 1 45 179 223 87 131 265 309 83 127 351 35 169 213 347 31 255 299 73 117 251 295 159 203 337 21 155 199 63 107 241 285 59 103 327 11 145 189 323 7 231 275 49 93 227 271 135 179 313 357 131 175 39 83 217 261 35 79 303 347 121 165 299 343 207 251 25 69 203 247 111 155 289 333 107 151 15 59 193 237 11 55 279 323 97 141 275 319 183 227 1 45 179 223 87 131 265 309 83 127 351 35 169 213 347 31 255 299 73 117
ph2 = (360) 22 246 290 244 288 242 286 150 194 148 192 146 190 54 98 52 96 50 94 318 2 316 0 314 358 222 266 220 264 218 262 126 170 124 168 122 166 30 74 28 72 26 70 294 338 292 336 290 334 198 242 196 240 194 238 102 146 100 144 98 142 6 50 4 48 2 46 270 314 268 312 266 310 174 218 172 216 170 214 78 122 76 120 74 118 342 26 340 24 338 22 246 290 244 288 242 286 150 194 148 192 146 190 54 98 52 96 50 94 318 2 316 0 314 358 222 266 220 264 218 262 126 170 124 168 122 166 30 74 28 72 26 70 294 338 292 336 290 334 198 242 196 240 194 238 102 146 100 144 98 142 6 50 4 48 2 46 270 314 268 312 266 310 174 218 172 216 170 214 78 122 76 120 74 118 342 26 340 24 338 22 246 290 244 288 242 286 150 194 148 192 146 190 54 98 52 96 50 94 318 2 316 0 314 358 222 266 220 264 218 262 126 170 124 168 122 166 30 74 28 72 26 70 294 338 292 336 290 334 198 242 196 240 194 238 102 146 100 144 98 142 6 50 4 48 2 46 270 314 268 312 266 310 174 218 172 216 170 214 78 122 76 120 74 118 342 26 340 24 338 22 246 290 244 288 242 286 150 194 148 192 146 190 54 98 52 96 50 94 318 2 316 0 314 358 222 266 220 264 218
ph3 = (360) 303 257 31 345 209 253 207 161 295 249 113 157 111 65 199 153 17 61 15 329 103 57 281 325 279 233 7 321 185 229 183 137 271 225 89 133 87 41 175 129 353 37 351 305 79 33 257 301 255 209 343 297 161 205 159 113 247 201 65 109 63 17 151 105 329 13 327 281 55 9 233 277 231 185 319 273 137 181 135 89 223 177 41 85 39 353 127 81 305 349 303 257 31 345 209 253 207 161 295 249 113 157 111 65 199 153 17 61 15 329 103 57 281 325 279 233 7 321 185 229 183 137 271 225 89 133 87 41 175 129 353 37 351 305 79 33 257 301 255 209 343 297 161 205 159 113 247 201 65 109 63 17 151 105 329 13 327 281 55 9 233 277 231 185 319 273 137 181 135 89 223 177 41 85 39 353 127 81 305 349 303 257 31 345 209 253 207 161 295 249 113 157 111 65 199 153 17 61 15 329 103 57 281 325 279 233 7 321 185 229 183 137 271 225 89 133 87 41 175 129 353 37 351 305 79 33 257 301 255 209 343 297 161 205 159 113 247 201 65 109 63 17 151 105 329 13 327 281 55 9 233 277 231 185 319 273 137 181 135 89 223 177 41 85 39 353 127 81 305 349 303 257 31 345 209 253 207 161 295 249 113 157 111 65 199 153 17 61 15 329 103 57 281 325 279 233 7 321 185 229

; measurement sequence for solid echo
ph29 = 0 2
ph30 = 1 3
ph31 = 0 2