; 19 January 2024
; Andrew Stasiuk
; ZZ MQC Expt under Hamiltonian XX - YY
; Time reversal by X<->Y interchange.
; 9 deg frame change
; M = 10 ==> td2=20 or pulse program will fail.

define delay tau1
"tau=d6-p1"
define delay tau2
"tau2=2*d6-p1"

define delay cycle
"cycle=12*d6"

"l10=0"

1   ze

2
    d1 rpp0 rpp1 rpp2 rpp3
    cycle pl2:f2

3
    (p1 ph0^):f2
    tau2
    (p1 ph1^):f2
    tau

    lo to 3 times l10

4
    (p1 ph2^):f2
    tau2
    (p1 ph3^):f2
    tau

    lo to 4 times l10

    d13
    (p1 ph30):f2

    go=2 ph31
    1m wr #0 if #0

    ; increment reverse evolution phase programs for Z encoding
    25m ph2*18
    25m ph3*18
    lo to 2 times td2

    ; increase time evolution counters, add additional FC offset to rev evolution
    1m iu10
    1m iu10
    1m iu10
    1m iu10
    25m ip2*72
    25m ip3*72
    lo to 2 times td1

  exit

ph0 = (360) 0 198 216 54 72 270 288 126 144 342 0 198 216 54 72 270 288 126 144 342 0 198 216 54 72 270 288 126 144 342 0 198 216 54 72 270 288 126 144 342 0 198 216 54 72 270 288 126 144 342 0 198 216 54 72 270 288 126 144 342 0 198 216 54 72 270 288 126 144 342 0 198 216 54 72 270 288 126 144 342 0 198 216 54 72 270 288 126 144 342 0 198 216 54 72 270 288 126 144 342
ph1 = (360) 9 207 225 63 81 279 297 135 153 351 9 207 225 63 81 279 297 135 153 351 9 207 225 63 81 279 297 135 153 351 9 207 225 63 81 279 297 135 153 351 9 207 225 63 81 279 297 135 153 351 9 207 225 63 81 279 297 135 153 351 9 207 225 63 81 279 297 135 153 351 9 207 225 63 81 279 297 135 153 351 9 207 225 63 81 279 297 135 153 351 9 207 225 63 81 279 297 135 153 351

ph2 = (360) 162 0 18 216 234 72 90 288 306 144 162 0 18 216 234 72 90 288 306 144 162 0 18 216 234 72 90 288 306 144 162 0 18 216 234 72 90 288 306 144 162 0 18 216 234 72 90 288 306 144 162 0 18 216 234 72 90 288 306 144 162 0 18 216 234 72 90 288 306 144 162 0 18 216 234 72 90 288 306 144 162 0 18 216 234 72 90 288 306 144 162 0 18 216 234 72 90 288 306 144
ph3 = (360) 171 9 27 225 243 81 99 297 315 153 171 9 27 225 243 81 99 297 315 153 171 9 27 225 243 81 99 297 315 153 171 9 27 225 243 81 99 297 315 153 171 9 27 225 243 81 99 297 315 153 171 9 27 225 243 81 99 297 315 153 171 9 27 225 243 81 99 297 315 153 171 9 27 225 243 81 99 297 315 153 171 9 27 225 243 81 99 297 315 153 171 9 27 225 243 81 99 297 315 153

ph30 = 1 3
ph31 = 0  2
